\doxysection{NVSRAM外部函数}
\label{group___n_v_s_r_a_m_xE5_xA4_x96_xE9_x83_xA8_xE5_x87_xBD_xE6_x95_xB0}\index{NVSRAM外部函数@{NVSRAM外部函数}}
\doxysubsection*{函数}
\begin{DoxyCompactItemize}
\item 
uint8\+\_\+t \textbf{ Nvsram\+\_\+\+Set\+\_\+\+Bp} (uint8\+\_\+t Level)
\begin{DoxyCompactList}\small\item\em NVSRAM 设置写保护. \end{DoxyCompactList}\item 
uint8\+\_\+t \textbf{ Nvsram\+\_\+\+Get\+\_\+\+Bp} (void)
\begin{DoxyCompactList}\small\item\em NVSRAM 获取写保护块. \end{DoxyCompactList}\item 
uint32\+\_\+t \textbf{ Nvsram\+\_\+\+Burst\+\_\+\+Write\+\_\+\+Buff} (uint32\+\_\+t nvsram\+\_\+addr, uint8\+\_\+t $\ast$w\+\_\+buf, uint32\+\_\+t len)
\begin{DoxyCompactList}\small\item\em NVSRAM 写内存函数 \end{DoxyCompactList}\item 
uint32\+\_\+t \textbf{ Nvsram\+\_\+\+Burst\+\_\+\+Read\+\_\+\+Buff} (uint32\+\_\+t nvsram\+\_\+addr, uint8\+\_\+t $\ast$r\+\_\+buf, uint32\+\_\+t len)
\begin{DoxyCompactList}\small\item\em NVSRAM 读内存函数 \end{DoxyCompactList}\item 
uint8\+\_\+t \textbf{ Nvsram\+\_\+\+Soft\+\_\+\+Store} (void)
\begin{DoxyCompactList}\small\item\em NVSRAM 软件存储 \end{DoxyCompactList}\item 
uint8\+\_\+t \textbf{ Nvsram\+\_\+\+Soft\+\_\+\+Recall} (void)
\begin{DoxyCompactList}\small\item\em NVSRAM 软件加载数据 \end{DoxyCompactList}\item 
uint8\+\_\+t \textbf{ Nvsram\+\_\+\+Set\+\_\+\+SN} (uint8\+\_\+t $\ast$sn\+\_\+buff)
\begin{DoxyCompactList}\small\item\em NVSRAM 设置序列号 \end{DoxyCompactList}\item 
void \textbf{ Nvsram\+\_\+\+Get\+\_\+\+SN} (uint8\+\_\+t $\ast$sn\+\_\+buff)
\begin{DoxyCompactList}\small\item\em NVSRAM 获取序列号 \end{DoxyCompactList}\item 
uint8\+\_\+t \textbf{ Nvsram\+\_\+\+Init} (void)
\begin{DoxyCompactList}\small\item\em NVSRAM 设备初始化 \end{DoxyCompactList}\item 
void \textbf{ Nvsram\+\_\+\+Get\+\_\+\+Struct} (\textbf{ Nvsram\+\_\+\+Struct\+\_\+t} $\ast$nvsram\+\_\+st)
\begin{DoxyCompactList}\small\item\em NVSRAM 获取设备状态 \end{DoxyCompactList}\item 
void \textbf{ Nvsram\+\_\+\+Test} (void)
\begin{DoxyCompactList}\small\item\em NVSRAM 驱动测试 \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{变量}
\begin{DoxyCompactItemize}
\item 
uint8\+\_\+t \textbf{ test\+\_\+tx} [\textbf{ NVSRAM\+\_\+\+BUF\+\_\+\+SIZE}] = \{0\}
\item 
uint8\+\_\+t \textbf{ test\+\_\+rx} [\textbf{ NVSRAM\+\_\+\+BUF\+\_\+\+SIZE}] = \{0\}
\end{DoxyCompactItemize}


\doxysubsection{详细描述}


\doxysubsection{函数说明}
\mbox{\label{group___n_v_s_r_a_m_xE5_xA4_x96_xE9_x83_xA8_xE5_x87_xBD_xE6_x95_xB0_gacdb13e6b2fe57b78973323441979bdbf}} 
\index{NVSRAM外部函数@{NVSRAM外部函数}!Nvsram\_Burst\_Read\_Buff@{Nvsram\_Burst\_Read\_Buff}}
\index{Nvsram\_Burst\_Read\_Buff@{Nvsram\_Burst\_Read\_Buff}!NVSRAM外部函数@{NVSRAM外部函数}}
\doxysubsubsection{Nvsram\_Burst\_Read\_Buff()}
{\footnotesize\ttfamily uint32\+\_\+t Nvsram\+\_\+\+Burst\+\_\+\+Read\+\_\+\+Buff (\begin{DoxyParamCaption}\item[{uint32\+\_\+t}]{nvsram\+\_\+addr,  }\item[{uint8\+\_\+t $\ast$}]{r\+\_\+buf,  }\item[{uint32\+\_\+t}]{len }\end{DoxyParamCaption})}



NVSRAM 读内存函数 

\begin{DoxyNote}{注解}
数据进行读操作时,如果地址大于0x1\+FFFF,地址将自动在0x00000中依次增加读取 

缓存区大小为 256Byte, SPI通信速率为 12.\+5\+MHZ 读速率为 262.\+83\+KByte/S ~\newline
 
\end{DoxyNote}

\begin{DoxyParams}[1]{参数}
\mbox{\texttt{ in}}  & {\em nvsram\+\_\+addr} & NVSRAM内存地址 0x00000–0x1\+FFFF \\
\hline
\mbox{\texttt{ out}}  & {\em r\+\_\+buf\+:读缓存区地址} & \\
\hline
\mbox{\texttt{ in}}  & {\em len\+:读字节长度} & \\
\hline
\end{DoxyParams}

\begin{DoxyRetVals}{返回值}
{\em 读出字节数量} & \\
\hline
\end{DoxyRetVals}
\mbox{\label{group___n_v_s_r_a_m_xE5_xA4_x96_xE9_x83_xA8_xE5_x87_xBD_xE6_x95_xB0_gad0779711b24d7a13165d32cfbabb4e06}} 
\index{NVSRAM外部函数@{NVSRAM外部函数}!Nvsram\_Burst\_Write\_Buff@{Nvsram\_Burst\_Write\_Buff}}
\index{Nvsram\_Burst\_Write\_Buff@{Nvsram\_Burst\_Write\_Buff}!NVSRAM外部函数@{NVSRAM外部函数}}
\doxysubsubsection{Nvsram\_Burst\_Write\_Buff()}
{\footnotesize\ttfamily uint32\+\_\+t Nvsram\+\_\+\+Burst\+\_\+\+Write\+\_\+\+Buff (\begin{DoxyParamCaption}\item[{uint32\+\_\+t}]{nvsram\+\_\+addr,  }\item[{uint8\+\_\+t $\ast$}]{w\+\_\+buf,  }\item[{uint32\+\_\+t}]{len }\end{DoxyParamCaption})}



NVSRAM 写内存函数 

\begin{DoxyNote}{注解}
1) 数据进行突发写操作时，当突发写到达一个受保护的块地址时，它将地址增 

量继续到受保护空间，但是不向受保护内存写入任何数据。如果地址增加到 

突发写操作带到未受保护的空间，然后恢复写入 

2) 数据进行突发写操作时，如果地址大于0x1\+FFFF，地址将自动在0x00000处依次增加写入 ~\newline
 

3) 缓存区大小为 256Byte, SPI通信速率为 12.\+5\+MHZ 写速率为 262.\+83\+KByte/S ~\newline
 
\end{DoxyNote}

\begin{DoxyParams}[1]{参数}
\mbox{\texttt{ in}}  & {\em nvsram\+\_\+addr\+:\+NVSRAM内存地址} & 0x00000–0x1\+FFFF \\
\hline
\mbox{\texttt{ in}}  & {\em w\+\_\+buf\+:写缓存区地址} & \\
\hline
\mbox{\texttt{ in}}  & {\em len\+:写入字节长度} & \\
\hline
\end{DoxyParams}

\begin{DoxyRetVals}{返回值}
{\em 写入字节数量} & \\
\hline
\end{DoxyRetVals}
\mbox{\label{group___n_v_s_r_a_m_xE5_xA4_x96_xE9_x83_xA8_xE5_x87_xBD_xE6_x95_xB0_ga478c20657faf549d5555aec2c7cc625f}} 
\index{NVSRAM外部函数@{NVSRAM外部函数}!Nvsram\_Get\_Bp@{Nvsram\_Get\_Bp}}
\index{Nvsram\_Get\_Bp@{Nvsram\_Get\_Bp}!NVSRAM外部函数@{NVSRAM外部函数}}
\doxysubsubsection{Nvsram\_Get\_Bp()}
{\footnotesize\ttfamily uint8\+\_\+t Nvsram\+\_\+\+Get\+\_\+\+Bp (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



NVSRAM 获取写保护块. 


\begin{DoxyRetVals}{返回值}
{\em NVSRAM\+\_\+\+BPL0} & 0 内存不保护 \\
\hline
{\em NVSRAM\+\_\+\+BPL1} & 1/4 内存保护 0x18000–0x1\+FFFF \\
\hline
{\em NVSRAM\+\_\+\+BPL2} & 1/2 内存保护 0x10000–0x1\+FFFF \\
\hline
{\em NVSRAM\+\_\+\+BPL3} & ALL 内存保护 0x00000–0x1\+FFFF \\
\hline
\end{DoxyRetVals}
\mbox{\label{group___n_v_s_r_a_m_xE5_xA4_x96_xE9_x83_xA8_xE5_x87_xBD_xE6_x95_xB0_gad5f934ee64d3e26f978ae5484ae83af8}} 
\index{NVSRAM外部函数@{NVSRAM外部函数}!Nvsram\_Get\_SN@{Nvsram\_Get\_SN}}
\index{Nvsram\_Get\_SN@{Nvsram\_Get\_SN}!NVSRAM外部函数@{NVSRAM外部函数}}
\doxysubsubsection{Nvsram\_Get\_SN()}
{\footnotesize\ttfamily void Nvsram\+\_\+\+Get\+\_\+\+SN (\begin{DoxyParamCaption}\item[{uint8\+\_\+t $\ast$}]{sn\+\_\+buff }\end{DoxyParamCaption})}



NVSRAM 获取序列号 


\begin{DoxyParams}[1]{参数}
\mbox{\texttt{ out}}  & {\em sn\+\_\+buff} & 序列号缓存区保存地址 该缓存区要大于等于8个字节 \\
\hline
\end{DoxyParams}
\mbox{\label{group___n_v_s_r_a_m_xE5_xA4_x96_xE9_x83_xA8_xE5_x87_xBD_xE6_x95_xB0_gafb7d9c1e633494c7fd995f2bb8d00d14}} 
\index{NVSRAM外部函数@{NVSRAM外部函数}!Nvsram\_Get\_Struct@{Nvsram\_Get\_Struct}}
\index{Nvsram\_Get\_Struct@{Nvsram\_Get\_Struct}!NVSRAM外部函数@{NVSRAM外部函数}}
\doxysubsubsection{Nvsram\_Get\_Struct()}
{\footnotesize\ttfamily void Nvsram\+\_\+\+Get\+\_\+\+Struct (\begin{DoxyParamCaption}\item[{\textbf{ Nvsram\+\_\+\+Struct\+\_\+t} $\ast$}]{nvsram\+\_\+st }\end{DoxyParamCaption})}



NVSRAM 获取设备状态 


\begin{DoxyParams}[1]{参数}
\mbox{\texttt{ out}}  & {\em nvsram\+\_\+st} & 设备状态结构体地址 \\
\hline
\end{DoxyParams}
\mbox{\label{group___n_v_s_r_a_m_xE5_xA4_x96_xE9_x83_xA8_xE5_x87_xBD_xE6_x95_xB0_gadc94c91020765c3995684f266cc91ee3}} 
\index{NVSRAM外部函数@{NVSRAM外部函数}!Nvsram\_Init@{Nvsram\_Init}}
\index{Nvsram\_Init@{Nvsram\_Init}!NVSRAM外部函数@{NVSRAM外部函数}}
\doxysubsubsection{Nvsram\_Init()}
{\footnotesize\ttfamily uint8\+\_\+t Nvsram\+\_\+\+Init (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



NVSRAM 设备初始化 

\begin{DoxyNote}{注解}
硬件初始化 等待设备就绪,加载\+ID号,加载序列号写入标志 
\end{DoxyNote}

\begin{DoxyRetVals}{返回值}
{\em NVSRAM\+\_\+\+SUCCEED\+:成功} & ~\newline
 \\
\hline
{\em NVSRAM\+\_\+\+PRAM\+\_\+\+ERRO\+:传入参数错误} & \\
\hline
{\em NVSRAM\+\_\+\+Busy\+:设备忙} & \\
\hline
\end{DoxyRetVals}
\mbox{\label{group___n_v_s_r_a_m_xE5_xA4_x96_xE9_x83_xA8_xE5_x87_xBD_xE6_x95_xB0_ga11b3551328ef6c0a824e9fb8b3550e05}} 
\index{NVSRAM外部函数@{NVSRAM外部函数}!Nvsram\_Set\_Bp@{Nvsram\_Set\_Bp}}
\index{Nvsram\_Set\_Bp@{Nvsram\_Set\_Bp}!NVSRAM外部函数@{NVSRAM外部函数}}
\doxysubsubsection{Nvsram\_Set\_Bp()}
{\footnotesize\ttfamily uint8\+\_\+t Nvsram\+\_\+\+Set\+\_\+\+Bp (\begin{DoxyParamCaption}\item[{uint8\+\_\+t}]{Level }\end{DoxyParamCaption})}



NVSRAM 设置写保护. 


\begin{DoxyParams}[1]{参数}
\mbox{\texttt{ in}}  & {\em Level} & 设置写保护等级 \begin{DoxyItemize}
\item \doxyref{NVSRAM\+\_\+\+BPL0}{p.}{group___n_v_s_r_a_m_xE5_xA4_x96_xE9_x83_xA8_xE6_x9E_x9A_xE4_xB8_xBE_xE4_xB8_x8E_xE7_xBB_x93_xE6_853622925b3b0431a0d994130f1cbec3_gga355ea421de17e28d214226a54f220289afd756c9aa0ce536c5c528843607ae5db} 0 内存不保护 \item \doxyref{NVSRAM\+\_\+\+BPL1}{p.}{group___n_v_s_r_a_m_xE5_xA4_x96_xE9_x83_xA8_xE6_x9E_x9A_xE4_xB8_xBE_xE4_xB8_x8E_xE7_xBB_x93_xE6_853622925b3b0431a0d994130f1cbec3_gga355ea421de17e28d214226a54f220289ad1ffca258ef5954a512c595974469e62} 1/4 内存保护 0x18000–0x1\+FFFF \item \doxyref{NVSRAM\+\_\+\+BPL2}{p.}{group___n_v_s_r_a_m_xE5_xA4_x96_xE9_x83_xA8_xE6_x9E_x9A_xE4_xB8_xBE_xE4_xB8_x8E_xE7_xBB_x93_xE6_853622925b3b0431a0d994130f1cbec3_gga355ea421de17e28d214226a54f220289a38b3296f4f63921b179e88efab58e8e0} 1/2 内存保护 0x10000–0x1\+FFFF \item \doxyref{NVSRAM\+\_\+\+BPL3}{p.}{group___n_v_s_r_a_m_xE5_xA4_x96_xE9_x83_xA8_xE6_x9E_x9A_xE4_xB8_xBE_xE4_xB8_x8E_xE7_xBB_x93_xE6_853622925b3b0431a0d994130f1cbec3_gga355ea421de17e28d214226a54f220289a905582ca0f6566822fc53430a8b48a55} ALL 内存保护 0x00000–0x1\+FFFF \end{DoxyItemize}
\\
\hline
\end{DoxyParams}

\begin{DoxyRetVals}{返回值}
{\em NVSRAM\+\_\+\+SUCCEED\+:成功} & ~\newline
 \\
\hline
{\em NVSRAM\+\_\+\+PRAM\+\_\+\+ERRO\+:传入参数错误} & \\
\hline
{\em NVSRAM\+\_\+\+Busy\+:设备忙} & \\
\hline
\end{DoxyRetVals}
\mbox{\label{group___n_v_s_r_a_m_xE5_xA4_x96_xE9_x83_xA8_xE5_x87_xBD_xE6_x95_xB0_gae5f4be18a5bad723247231d671863c99}} 
\index{NVSRAM外部函数@{NVSRAM外部函数}!Nvsram\_Set\_SN@{Nvsram\_Set\_SN}}
\index{Nvsram\_Set\_SN@{Nvsram\_Set\_SN}!NVSRAM外部函数@{NVSRAM外部函数}}
\doxysubsubsection{Nvsram\_Set\_SN()}
{\footnotesize\ttfamily uint8\+\_\+t Nvsram\+\_\+\+Set\+\_\+\+SN (\begin{DoxyParamCaption}\item[{uint8\+\_\+t $\ast$}]{sn\+\_\+buff }\end{DoxyParamCaption})}



NVSRAM 设置序列号 

\begin{DoxyNote}{注解}
内部有8个字节的序列号空间，但只能被写一次(保存到量子陷阱之后), 

写一次之后,状态寄存器中\+SNL bit 为1,并且永远不能擦除该标志位,序列号 

永远不能再被更改,由于需要存储功能,将会耗时6ms左右,不建议将此函数放入线程中使用 
\end{DoxyNote}

\begin{DoxyParams}[1]{参数}
\mbox{\texttt{ in}}  & {\em sn\+\_\+buff} & 序列号缓存区保存地址 该缓存区要大于等于8个字节 \\
\hline
\end{DoxyParams}

\begin{DoxyRetVals}{返回值}
{\em NVSRAM\+\_\+\+SUCCEED\+:成功} & ~\newline
 \\
\hline
{\em NVSRAM\+\_\+\+PRAM\+\_\+\+ERRO\+:传入参数错误} & \\
\hline
{\em NVSRAM\+\_\+\+Busy\+:设备忙} & \\
\hline
\end{DoxyRetVals}
\mbox{\label{group___n_v_s_r_a_m_xE5_xA4_x96_xE9_x83_xA8_xE5_x87_xBD_xE6_x95_xB0_gaa506268095b30eecfee6ee24dda91ec7}} 
\index{NVSRAM外部函数@{NVSRAM外部函数}!Nvsram\_Soft\_Recall@{Nvsram\_Soft\_Recall}}
\index{Nvsram\_Soft\_Recall@{Nvsram\_Soft\_Recall}!NVSRAM外部函数@{NVSRAM外部函数}}
\doxysubsubsection{Nvsram\_Soft\_Recall()}
{\footnotesize\ttfamily uint8\+\_\+t Nvsram\+\_\+\+Soft\+\_\+\+Recall (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



NVSRAM 软件加载数据 

\begin{DoxyNote}{注解}
将量子陷阱中数据加载到内部\+SDRAM数据中,由于存储需要一定的时间,如果设备可以上电加载, 

不建议使用该函数 
\end{DoxyNote}

\begin{DoxyRetVals}{返回值}
{\em NVSRAM\+\_\+\+SUCCEED\+:成功} & ~\newline
 \\
\hline
{\em NVSRAM\+\_\+\+PRAM\+\_\+\+ERRO\+:传入参数错误} & \\
\hline
{\em NVSRAM\+\_\+\+Busy\+:设备忙} & \\
\hline
\end{DoxyRetVals}
\mbox{\label{group___n_v_s_r_a_m_xE5_xA4_x96_xE9_x83_xA8_xE5_x87_xBD_xE6_x95_xB0_ga1e9fa9d6d93f85039696c348e3a2873f}} 
\index{NVSRAM外部函数@{NVSRAM外部函数}!Nvsram\_Soft\_Store@{Nvsram\_Soft\_Store}}
\index{Nvsram\_Soft\_Store@{Nvsram\_Soft\_Store}!NVSRAM外部函数@{NVSRAM外部函数}}
\doxysubsubsection{Nvsram\_Soft\_Store()}
{\footnotesize\ttfamily uint8\+\_\+t Nvsram\+\_\+\+Soft\+\_\+\+Store (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



NVSRAM 软件存储 

\begin{DoxyNote}{注解}
将内部\+SDRAM数据存储到量子陷阱中,由于存储需要一定的时间,如果设备可以掉电保存, 

不建议使用该函数 
\end{DoxyNote}

\begin{DoxyRetVals}{返回值}
{\em NVSRAM\+\_\+\+SUCCEED\+:成功} & ~\newline
 \\
\hline
{\em NVSRAM\+\_\+\+PRAM\+\_\+\+ERRO\+:传入参数错误} & \\
\hline
{\em NVSRAM\+\_\+\+Busy\+:设备忙} & \\
\hline
\end{DoxyRetVals}
\mbox{\label{group___n_v_s_r_a_m_xE5_xA4_x96_xE9_x83_xA8_xE5_x87_xBD_xE6_x95_xB0_ga364a61ea29bed180d21a9e86add7b662}} 
\index{NVSRAM外部函数@{NVSRAM外部函数}!Nvsram\_Test@{Nvsram\_Test}}
\index{Nvsram\_Test@{Nvsram\_Test}!NVSRAM外部函数@{NVSRAM外部函数}}
\doxysubsubsection{Nvsram\_Test()}
{\footnotesize\ttfamily void Nvsram\+\_\+\+Test (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



NVSRAM 驱动测试 

\begin{DoxyNote}{注解}
1)设备初始化测试,函数运行时间,设备\+ID,设备序列号是否写入 

2)设备软件保存指令检测 测试运行时间 

3)设备软件数据加载指令检测 测试运行时间 

4)设备写函数测试（一次写一个缓存区） 

5)设备读函数测试（一次读一个缓存区） 

6)设备写函数测试（128\+K内存）测试写入运行时间 

7)设备读函数测试（128\+K内存）测试写入读出数据的正确性 ~\newline
 

8)设备读函数测试（128\+K内存）测试读出运行时间 

9)设备掉电数据保存测试 调试状态将内存中写入数据 0x55 

断电重启,设备初始化之后,读出数据，判断数据全为0x55 ~\newline
 

10)设备块保护测试 NVSRAM\+\_\+\+BPL0 （128\+K内存）写入0x11 读出数据判断是否一致 

NVSRAM\+\_\+\+BPL1 （128\+K内存）写入0x22 读出数据判断是否一致 

NVSRAM\+\_\+\+BPL2 （128\+K内存）写入0x33 读出数据判断是否一致 

NVSRAM\+\_\+\+BPL3 （128\+K内存）写入0x44 读出数据判断是否一致 

解除块保护 （128\+K内存）写入0x55 读出数据判断是否一致 
\end{DoxyNote}


\doxysubsection{变量说明}
\mbox{\label{group___n_v_s_r_a_m_xE5_xA4_x96_xE9_x83_xA8_xE5_x87_xBD_xE6_x95_xB0_gac164f082c9da49393facb1909ba74c61}} 
\index{NVSRAM外部函数@{NVSRAM外部函数}!test\_rx@{test\_rx}}
\index{test\_rx@{test\_rx}!NVSRAM外部函数@{NVSRAM外部函数}}
\doxysubsubsection{test\_rx}
{\footnotesize\ttfamily uint8\+\_\+t test\+\_\+rx[\textbf{ NVSRAM\+\_\+\+BUF\+\_\+\+SIZE}] = \{0\}}

\mbox{\label{group___n_v_s_r_a_m_xE5_xA4_x96_xE9_x83_xA8_xE5_x87_xBD_xE6_x95_xB0_ga7996ec6839914827f19889cef3814d8f}} 
\index{NVSRAM外部函数@{NVSRAM外部函数}!test\_tx@{test\_tx}}
\index{test\_tx@{test\_tx}!NVSRAM外部函数@{NVSRAM外部函数}}
\doxysubsubsection{test\_tx}
{\footnotesize\ttfamily uint8\+\_\+t test\+\_\+tx[\textbf{ NVSRAM\+\_\+\+BUF\+\_\+\+SIZE}] = \{0\}}

